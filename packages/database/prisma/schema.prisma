generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Fund {
  // the funds contract id
  id          String   @id @map("_id")
  name        String
  description String
  // In atto alph format
  // Using a string to avoid headaches associated with
  // passing bigint across network boundaries as JSON
  goal        String
  deadline    DateTime
  beneficiary String
  organizer   String
  // The tokens donated to this fund
  tokens      Token[]
  // we eagerly create the fund before verifying the transaction actually exists
  // to provide a smooth ui when users are creating a new fund
  // if verified is false we have not actually seen the fund on the network yet
  // if it is true, we have seen the fund and it is legit
  verified    Boolean
  txId        String
  confirmed   Boolean  @default(false)
  // TODO get timestamp from blockchain
  createdAt   DateTime @default(now())
}

type Token {
  id     String
  amount String
}

model Indexer {
  id     String @id @default(auto()) @map("_id") @db.ObjectId
  height Int
}
